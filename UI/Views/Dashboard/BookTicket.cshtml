@{
    ViewData["Title"] = "Đặt vé";
    Layout = "_DashboardLayout";
}

@section Styles {
    <link rel="stylesheet" href="~/css/book-ticket.css" asp-append-version="true" />
}

<div class="card shadow-sm h-100">
    <div class="card-header bg-primary text-white">
        <h4 class="mb-0">
            <i class="fas fa-ticket-alt me-2"></i>
            Đặt vé cho khách hàng
        </h4>
    </div>
    <div class="card-body">
        <!-- Wizard Steps -->
        <div class="wizard-steps mb-4">
            <div class="step-indicator">
                <div class="step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-title">Chọn phim & suất chiếu</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-title">Chọn ghế</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-title">Xác nhận & thanh toán</div>
                </div>
            </div>
        </div>

        <!-- Step Content -->
        <div id="step-content">
            <!-- Step 1 will be loaded here -->
        </div>
    </div>
</div>

<style>
.wizard-steps {
    display: flex;
    justify-content: center;
    margin-bottom: 2rem;
}

.step-indicator {
    display: flex;
    align-items: center;
    gap: 2rem;
}

.step {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    position: relative;
}

.step:not(:last-child)::after {
    content: '';
    position: absolute;
    top: 20px;
    left: 100%;
    width: 2rem;
    height: 2px;
    background-color: #dee2e6;
    z-index: -1;
}

.step.active:not(:last-child)::after {
    background-color: #007bff;
}

.step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #dee2e6;
    color: #6c757d;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.step.active .step-number {
    background-color: #007bff;
    color: white;
}

.step.completed .step-number {
    background-color: #28a745;
    color: white;
}

.step-title {
    font-size: 0.875rem;
    color: #6c757d;
    max-width: 120px;
}

.step.active .step-title {
    color: #007bff;
    font-weight: 600;
}
</style>

<script>
$(document).ready(function() {
    // Load Step 1 initially
    loadStep(1);
});

function loadStep(stepNumber) {
    // Update step indicator
    $('.step').removeClass('active completed');
    for (let i = 1; i < stepNumber; i++) {
        $(`.step[data-step="${i}"]`).addClass('completed');
    }
    $(`.step[data-step="${stepNumber}"]`).addClass('active');
    
    // Load step content
    const stepUrls = {
        1: '@Url.Action("BookTicketStep1", "Dashboard")',
        2: '@Url.Action("BookTicketStep2", "Dashboard")',
        3: '@Url.Action("BookTicketStep3", "Dashboard")'
    };
    
    $('#step-content').load(stepUrls[stepNumber]);
}

function nextStep(currentStep) {
    if (currentStep < 3) {
        loadStep(currentStep + 1);
    }
}

function prevStep(currentStep) {
    if (currentStep > 1) {
        loadStep(currentStep - 1);
    }
}
</script>